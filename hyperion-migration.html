<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="section" id="for-users-channel-operators">
<h1>For users / channel operators</h1>
<div class="section" id="things-that-are-new">
<h2>Things that are new</h2>
<ul class="simple">
<li>Extended ban types. Modules can add new ban types which can match on
any information the ircd can access. Several are available in the
source distribution, including realname, services account name, IRC
operator status, channel membership and ability to join other
channels. These can all be used for +b, +q, +e and +I.</li>
<li>User mode +g (callerid) is supported.</li>
<li>SSL support, for clients and servers.</li>
</ul>
</div>
<div class="section" id="things-that-are-gone">
<h2>Things that are gone</h2>
<ul class="simple">
<li>SILENCE. The replacement is user mode +g and /accept.</li>
<li>Channel mode +m no longer prevents nick changes.</li>
<li>Channel mode +R no longer exists as a simple mode -- use +q $~a to
achieve the same effect. If you notice unregistered users cannot
speak in your channel, check /mode #channel +q to ensure there is
no ban on $~a.</li>
<li>User mode +u (extendchans) is no longer necessary.</li>
</ul>
</div>
<div class="section" id="things-that-are-different">
<h2>Things that are different</h2>
<ul class="simple">
<li>channel mode +d (realname ban) is replaced by +b $r:&lt;foo&gt; -- see
'Extended ban types' above. This means that quiets, exempts and
invexes can also be set based on realname, and forward channels can be
used with realname bans.</li>
<li>CAPAB IDENTIFY-MSG is present, but the commands to enable it are
different -- use <tt class="docutils literal"><span class="pre">CAP</span> <span class="pre">REQ</span> <span class="pre">:identify-msg</span> <span class="pre">``</span> <span class="pre">to</span> <span class="pre">enable</span> <span class="pre">it;</span> <span class="pre">the</span> <span class="pre">response</span>
<span class="pre">if</span> <span class="pre">successful</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">``:server.name</span> <span class="pre">CAP</span> <span class="pre">&lt;nick&gt;</span> <span class="pre">ACK</span> <span class="pre">:identify-msg</span></tt>.
An updated version of format_identify.pl for Irssi, which understands
both the ircd-seven and hyperion methods, is at
<a class="reference external" href="http://adipose.attenuate.org/~stephen/ircd-seven/format_identify.pl.txt">http://adipose.attenuate.org/~stephen/ircd-seven/format_identify.pl.txt</a>.
This client capability can now also be turned off -- use
<tt class="docutils literal"><span class="pre">CAP</span> <span class="pre">REQ</span> <span class="pre">:-identify-msg</span></tt>.</li>
<li>Channel modes +q and +b, which were always separate internally, are no
longer presented to the client in the same list. Prepending '%' to a
ban mask to make a quiet will no longer work.</li>
<li>Forwarding bans now use $ instead of ! to delimit the forward channel,
and can be used in conjunction with extended ban types. Setting and
unsetting of forwarding bans using the hyperion syntax still works,
however -- the ircd translates them into its own format.</li>
<li>Join throttling has changed slightly -- where hyperion uses +J x,y
seven has +j x:y. The algorithm is rather simpler as well: x joins in
y seconds.</li>
<li>Setting of channel forwards, whether by mode +f or by a forwarding
ban, requires channel operator status in both the source and target
channels, unless the latter has channel mode +F (free forwarding).</li>
</ul>
</div>
</div>
<div class="section" id="for-opers">
<h1>For opers</h1>
<div class="section" id="id1">
<h2>Things that are new</h2>
<ul class="simple">
<li>seven is modular -- the core is relatively small; almost all commands
are handled by loadable modules. Changes to these modules can be
deployed without any disruption to users, and new commands, ban types
and certain user/channel modes can be added without needing to restart
any daemons.</li>
<li>DIE and RESTART can be used remotely.</li>
<li>D:lines can be added and removed remotely.</li>
<li>X:lines can be added and removed via IRC, in the same way as K:lines</li>
<li>Q:lines and channel jupes are replaced by RESVs, which can similarly
be added and removed via IRC.</li>
<li>All server notice umodes have been collapsed into a parameter to user
mode +s. Use /quote help snomask for a list of the available masks.</li>
<li>A new auth_user option for I:line blocks. If a user connects
specifying a server password that contains a colon, then the part of
the password field before the colon will be used as a 'username' to
select their I:line, while the part after the colon is used as a
password. This allows people to be given spoofed I:lines without being
restricted to a given host range (or, in hyperion, nickname), and
without affecting any other users who share that range (or happen to
connect with that nick).</li>
<li>A new channel mode +M, which disallows kicking any IRC operators. It
can only be set or unset by operators with the 'cmodes' flag (see
below), and is intended as a replacement for user mode +m.</li>
</ul>
</div>
<div class="section" id="id2">
<h2>Things that are gone</h2>
<ul class="simple">
<li>channel mode +D. Use services instead.</li>
<li>Most of the functionality in SCAN -- only SCAN UMODES is supported.</li>
<li>Nickname-based I:lines. See the section on auth_user above for the
replacement.</li>
<li>User mode +m. See channel mode +M, above.</li>
<li>It is not possible to change another user's modes.</li>
<li>The over-zealous serverhide implementation. seven's server hiding is
much more moderate, showing which client servers are present but
hiding routing layout and hub names.</li>
</ul>
</div>
<div class="section" id="id3">
<h2>Things that are different</h2>
<ul class="simple">
<li>The whole oper privilege system. With one exception (+p), user modes
do not confer any privilege. Instead, each operator is assigned one
privilege set, either by their O:line or the GRANT command. This set
is defined in the ircd configuration, and contains a list of privilege
flags conferred to that operator. See full description below.</li>
<li>User mode +p is slightly less ridiculous in scope. It still allows the
user to join any channel, and allows sending to, and most operator
actions in, any channel that the user is in. It does not, however,
bypass channel mode +n, nor does it allow operator status in channels
that the user has not joined.</li>
<li>User mode +T has been replaced by +h. Same purpose, less silly mode
letter.</li>
<li>User auspex (hyperion's +a umode) operates slightly differently. An
operator with the auspex flag will not automatically see all channels
a user is in with /whois; by default they will see the same list a
normal user would. Ditto for /who and /names on a channel, and so
forth. Most of these commands have an 'operspy' variant accessed by
prepending a ! to the target name -- for instance, <tt class="docutils literal"><span class="pre">/whois</span> <span class="pre">!user</span></tt> or
<tt class="docutils literal"><span class="pre">/who</span> <span class="pre">!#channel</span></tt>, which will show the restricted information. However,
items not accessible to normal users will be prefixed with '!', and a
server notice will be sent out to opers with snomask +Z active when it
is used.</li>
<li>Unlike in hyperion, rehash is <em>not</em> required after removing a K:line.</li>
</ul>
</div>
</div>
<div class="section" id="the-operator-privilege-system">
<h1>The operator privilege system</h1>
<p>Forget completely, for the moment, how Hyperion handles operator
privilege. Trying to compare the two system side by side is more
confusing than helpful.</p>
<p>In ircd-seven, there are essentially two types of IRC operator. For want
of better words, they are known internally as 'opers' and 'helpers'. A
helper is an IRC operator who does not have the 'oper:staffer' privilege
flag. When a helper opers up, instead of user mode +o, they get mode +O.
This denotes them as being opered up in a helper role, and confers none
of the privilege that +o does. Dependent upon the other flags granted in
their privilege set, helpers can get access to some subset of operator
functionality, though the user mode itself grants none. Operwall access
can be granted to helpers, though most other restricted commands will
not be accessible even if the appropriate privilege is given. Most
operator privileges that affect the behaviour of normal user commands
can be granted to helpers, including the oper:helpop flag to appear in
/stats p output.</p>
<p>For the operator who does have the oper:staffer flag, he can gain
access to user mode +o, but not +O. This mode does confer a fairly
sizeable chunk of privilege, including:</p>
<ul class="simple">
<li>Immunity from rate-limiting for most commands.</li>
<li>The ability to use most restricted STATS commands, as well as most
informational commands that are restricted, such as MAP, TESTLINE,
unadulterated LINKS output, {E,MASK,CHAN}TRACE and various others.</li>
<li>Access to server notices. A small number are sent only to server
administrators (those with user mode +a, granted by the 'oper:admin'
flag), but the vast majority are accessible to all operators.</li>
<li>The ability to see the real hostname and IP address of cloaked users.
This information is accessible via various server notices anyway, so
further restricting it is relatively pointless.</li>
<li>The ability to see, but not to change, routing information.</li>
<li>The ability to bypass most restrictions on private messages, including
user mode +g.</li>
</ul>
<p>Whichever mode an operator has, O or o, the method for granting
privilege is the same. The ircd configuration contains one or more
'privset' blocks, which define a privilege set and the flags that make
up that set. For example:</p>
<pre class="literal-block">
privset &quot;levelone&quot; {
    privs = oper:operwall, oper:helpop;
};

privset &quot;staffer&quot; {
    extends = &quot;levelone&quot;;
    privs = oper:staffer, oper:kill, oper:kline;
};
</pre>
<p>Instead of a user's O:line (or operator block) defining a set of user
modes, as in hyperion, or flags, as in hybrid/ratbox, it contains the
name of a single privilege set, which will be granted to the operator
when he/she opers up. It is the privilege set that determines his or her
precise privileges.</p>
<p>And so, to the current list of available privileges, and their
(approximate) equivalent user modes in hyperion.</p>
<dl class="docutils">
<dt>oper:helpop</dt>
<dd>Allows access to user mode +h, to appear in /stats p output.
Equivalent to hyperion +T.</dd>
<dt>oper:operwall</dt>
<dd>Allows use of the /operwall command, and access to umode +z to
receive operwalls.
Equivalent to hyperion +zZ.</dd>
<dt>oper:staffer</dt>
<dd>Grants user mode +o instead of +O on oper-up. This confers several
miscellaneous privileges. Roughly equivalent to hyperion
+AbcdfhklnorsvVxXyY01234569.</dd>
<dt>oper:kill</dt>
<dd>Allows use of the /kill command, locally and globally.
Equivalent to hyperion +G and part of +K.</dd>
<dt>oper:kline</dt>
<dd>Allows setting of K:lines with the default cluster settings (i.e.
netwide). Equivalent to the other part of hyperion +K.</dd>
<dt>oper:unkline</dt>
<dd>Allows removal of K:lines. Equivalent to hyperion +U.</dd>
<dt>oper:rehash</dt>
<dd>Allows use of /rehash and /set commands. Equivalent to hyperion +H.</dd>
<dt>oper:auspex</dt>
<dd>Allows use of operspy variants of various commands. Approximately
analogous to hyperion +a.</dd>
<dt>oper:cmodes</dt>
<dd>Allows setting of operator-only channel modes -- +L, +P, +M. I
don't remember which modes in hyperion grant this.</dd>
<dt>oper:override</dt>
<dd>Allows access to user mode +p. Roughly equivalent, surprisingly, to
hyperion's +p.</dd>
<dt>oper:massnotice</dt>
<dd>Allows use of NOTICE and PRIVMSG to host masks, as well as WALLOPS.
Equivalent to hyperion +MW.</dd>
<dt>oper:routing</dt>
<dd>Allows use of routing commands -- CONNECT and SQUIT. Equivalent to
hyperion +R.</dd>
<dt>oper:xline</dt>
<dd>Allows use of the XLINE command to add X:lines. No equivalent in
hyperion.</dd>
<dt>oper:resv</dt>
<dd>Allows use of the RESV command to forbid use of a given nickname or
channel name. No equivalent in hyperion.</dd>
<dt>oper:remoteban</dt>
<dd>Allows use of KLINE, XLINE, DLINE, RESV, and the corresponding UN*
commands, on specific named servers. Without this, they can only be
added or removed according to the cluster settings in the
configuration -- most likely network-wide.</dd>
<dt>oper:admin</dt>
<dd>Allows access to user mode +a. Allows use of various stats commands
and server notices that are denied to other operators. Most notably,
allows use of module commands -- MODLOAD, MODUNLOAD, MODRELOAD and
MODRESTART. No equivalent in hyperion.</dd>
<dt>oper:die</dt>
<dd>Allows use of DIE and RESTART commands, locally and remotely.
Equivalent to hyperion's +D.</dd>
<dt>oper:grant</dt>
<dd>Allows use of the GRANT command, to change the privilege set of
another user. Approximately analagous to +B* in hyperion.</dd>
</dl>
<p>For quick reference, the privilege sets currently in use on the
ircd-seven test net are:</p>
<pre class="literal-block">
privset &quot;levelone&quot; {
    privs = oper:operwall, oper:helpop;
};

privset &quot;staffer&quot; {
    extends = &quot;levelone&quot;;
    privs = oper:staffer, oper:kill, oper:kline;
};

privset &quot;staffer2&quot; {
    extends = &quot;staffer&quot;;
    privs = oper:unkline, oper:rehash, oper:auspex, oper:cmodes, oper:override, oper:routing;
};

privset &quot;admin&quot; {
    extends = &quot;staffer2&quot;;
    privs = oper:massnotice, oper:xline, oper:resv, oper:remoteban, oper:admin, oper:die, oper:grant;
};
</pre>
<!-- vim: set sw=4 sts=4 tw=72 et : -->
</div>
</div>
</body>
</html>
